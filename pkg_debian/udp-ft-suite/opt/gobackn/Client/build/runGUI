#!/bin/bash

# Find the directory where this script resides
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

# Determine the base directory of the installation
BASE_DIR="$(dirname "$(dirname "$SCRIPT_DIR")")" # Goes up two levels from Client/build to gobackn

# Define the path to the bundled libraries
LIB_DIR="${BASE_DIR}/lib"

# Define the path to the actual executable
REAL_EXE="${SCRIPT_DIR}/ClientUI"

# Set the library path for the executable
# The ${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH} part ensures we don't overwrite
# any existing LD_LIBRARY_PATH, but rather prepend our directory.
export LD_LIBRARY_PATH="${LIB_DIR}${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"

# Bundling Qt plugins in /opt/gobackn/lib/plugins:
export QT_PLUGIN_PATH="${LIB_DIR}/plugins"

# Execute the real application, passing all arguments through
exec "$REAL_EXE" "$@"
